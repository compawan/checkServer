<!DOCTYPE html>
<html>
  <head>
    <title>Remote Control</title>
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
  </head>
  <body>
    <img id="screen" src="http://checkserver-rmqt.onrender.com/stream" />
   <script>
      const socket = io("https://checkserver-rmqt.onrender.com");
      const img = document.getElementById("screen");
    
      let deviceWidth = 1080;   // default or override
      let deviceHeight = 1920;
    
      // listen for server-provided device dimensions
      socket.on("deviceInfo", data => {
         deviceWidth = data.width;
         deviceHeight = data.height;
         console.log(`device: ${deviceWidth} x ${deviceHeight}`);
      });
    
      img.addEventListener("click", e => {
        const displayWidth = img.clientWidth;
        const displayHeight = img.clientHeight;
    
        const scaleX = deviceWidth / displayWidth;
        const scaleY = deviceHeight / displayHeight;
    
        const realX = e.offsetX * scaleX;
        const realY = e.offsetY * scaleY;
    
        socket.emit("touch", {
          type: "tap",
          x: realX,
          y: realY
        });
      });
    </script>
  </body>
</html>
