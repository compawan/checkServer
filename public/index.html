<!DOCTYPE html>
<html>
  <head>
    <title>Remote Control</title>
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
  </head>
  <body>
    <h2>Remote Control</h2>
    <input id="idBox" placeholder="Enter device ID" />
    <button id="connectBtn">Connect</button>
    <br />
    <img id="screen" style="max-width:100%; display:none;" />
    <script>
      const socket = io("https://checkserver-rmqt.onrender.com");
      const img = document.getElementById("screen");
      const button = document.getElementById("connectBtn");
      const input = document.getElementById("idBox");

      let currentId = null;

      button.addEventListener("click", () => {
        const id = input.value.trim();
        if (id) {
          currentId = id;
          socket.emit("viewer_connect", { id });
          img.src = `https://checkserver-rmqt.onrender.com/stream?id=${id}`;
          img.style.display = "block";
        }
      });

      img.addEventListener("click", e => {
        if (!currentId) return;
        socket.emit("touch", {
          id: currentId,
          x: e.offsetX,
          y: e.offsetY,
          type: "tap"
        });
      });

      document.addEventListener("keydown", e => {
        if (!currentId) return;
        socket.emit("key", {
          id: currentId,
          key: e.key,
          code: e.code,
          keyCode: e.keyCode
        });
      });
    </script>
  </body>
</html>
